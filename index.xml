<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">

<front>
<journal-meta>
<journal-id></journal-id>

<journal-title-group>
<journal-title>Earth and Space Science</journal-title>
</journal-title-group>
<issn></issn>

<publisher>
<publisher-name></publisher-name>
</publisher>
</journal-meta>


<article-meta>


<title-group>
<article-title>PM2 and PM10 concentrations</article-title>
</title-group>

<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0001-9775-1924</contrib-id>
<name>
<surname>Munkhtsetseg</surname>
<given-names>Erdenebayar</given-names>
</name>
<string-name>Erdenebayar Munkhtsetseg</string-name>

<email>e.munkhtsetseg@yahoo.com</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="project
administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration/">Project
administration</role>
<role vocab="https://credit.niso.org" vocab-term="software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software/">Software</role>
<role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
<xref ref-type="aff" rid="aff-1">a</xref>
<xref ref-type="aff" rid="aff-2">b</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0000-0000-0000-0000</contrib-id>
<name>
<surname>Shimizu</surname>
<given-names>Atsushi</given-names>
</name>
<string-name>Atsushi Shimizu</string-name>

<email>shimizua@nies.go.jp</email>
<role vocab="https://credit.niso.org" vocab-term="writing – review &amp;
editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing/">Editing</role>
<role>Revising</role>
<xref ref-type="aff" rid="aff-3">c</xref>
<xref ref-type="corresp" rid="cor-2">&#x002A;</xref>
</contrib>
</contrib-group>
<aff id="aff-1">
<institution-wrap>
<institution>National University of Mongolia (NUM),
Mongolia</institution>
</institution-wrap>







</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Kanazawa University, Japan</institution>
</institution-wrap>







</aff>
<aff id="aff-3">
<institution-wrap>
<institution>National Institute for Environmental Studies (NIES),
Japan</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-2">shimizua@nies.go.jp</corresp>
</author-notes>

<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-01-23">
<year>2024</year>
<month>1</month>
<day>23</day>
</pub-date>







<history></history>


<abstract>
<p>In September 2021, a significant jump in seismic activity on the
island of La Palma (Canary Islands, Spain) signaled the start of a
volcanic crisis that still continues at the time of writing. Earthquake
data is continually collected and published by the Instituto Geográphico
Nacional (IGN). …</p>
</abstract>
<kwd-group kwd-group-type="author">
<kwd>particulate matters</kwd>
<kwd>concentrations of PM10 and PM2.5</kwd>
</kwd-group>




</article-meta>

</front>

<body>
<sec id="introduction">
  <title>0.1 Introduction</title>
  <fig id="fig-timeline">
    <caption><p>Figure 1: Timeline of recent earthquakes on La
    Palma</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/fig-timeline-1.png" />
  </fig>
  <p>Based on data up to and including 1971, eruptions on La Palma
  happen every 79.8 years on average.</p>
  <p>Studies of the magma systems feeding the volcano, such as Marrero
  et al.
  (<xref alt="2019" rid="ref-marrero2019" ref-type="bibr">2019</xref>),
  have proposed that there are two main magma reservoirs feeding the
  Cumbre Vieja volcano; one in the mantle (30-40km depth) which charges
  and in turn feeds a shallower crustal reservoir (10-20km depth).</p>
  <p>Eight eruptions have been recorded since the late 1400s
  (<xref alt="Figure 1" rid="fig-timeline">Figure 1</xref>).</p>
  <p>Data and methods are discussed in
  <xref alt="Section 4.3" rid="sec-data-methods">Section 4.3</xref>.</p>
  <p>Let <inline-formula><alternatives>
  <tex-math><![CDATA[x]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
  denote the number of eruptions in a year. Then,
  <inline-formula><alternatives>
  <tex-math><![CDATA[x]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
  can be modeled by a Poisson distribution</p>
  <p><styled-content id="eq-poisson"><disp-formula><alternatives>
  <tex-math><![CDATA[
  p(x) = \frac{e^{-\lambda} \lambda^{x}}{x !}
   \qquad(1)]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi>!</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[\lambda]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>
  is the rate of eruptions per year. Using
  <xref alt="Equation 1" rid="eq-poisson">Equation 1</xref>, the
  probability of an eruption in the next <inline-formula><alternatives>
  <tex-math><![CDATA[t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
  years can be calculated.</p>
  <fig id="tbl-history">
    <caption><p>Table 1: Recent historic eruptions on La
    Palma</p></caption>
    <table-wrap>
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Year</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Current</td>
            <td>2021</td>
          </tr>
          <tr>
            <td>Teneguía</td>
            <td>1971</td>
          </tr>
          <tr>
            <td>Nambroque</td>
            <td>1949</td>
          </tr>
          <tr>
            <td>El Charco</td>
            <td>1712</td>
          </tr>
          <tr>
            <td>Volcán San Antonio</td>
            <td>1677</td>
          </tr>
          <tr>
            <td>Volcán San Martin</td>
            <td>1646</td>
          </tr>
          <tr>
            <td>Tajuya near El Paso</td>
            <td>1585</td>
          </tr>
          <tr>
            <td>Montaña Quemada</td>
            <td>1492</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </fig>
  <p><xref alt="Table 1" rid="tbl-history">Table 1</xref> summarises the
  eruptions recorded since the colonization of the islands by Europeans
  in the late 1400s.</p>
  <fig id="fig-map">
    <caption><p>Figure 2: Map of La Palma</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/la-palma-map.png" />
  </fig>
  <p>La Palma is one of the west most islands in the Volcanic
  Archipelago of the Canary Islands
  (<xref alt="Figure 2" rid="fig-map">Figure 2</xref>).</p>
  <fig id="fig-spatial-plot">
    <caption><p>Figure 3: Locations of earthquakes on La Palma since
    2017</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/notebooks-explore-earthquakes-fig-spatial-plot-output-1.png" />
  </fig>
  <p>kk</p>
</sec>
<sec id="explore-earthquakes">
  <title>1. Explore Earthquakes</title>
  <p>Munkhtsetseg</p>
  <p>Library</p>
</sec>
<sec id="import-the-dataset-and-remove-the-duplicates">
  <title>2. Import the dataset and remove the duplicates</title>
  <p>Import the dataset from the directory of: ~/Data
  Input/Preprocessing data/Preprocessing data.csv, assign the dataset as
  object of df:</p>
  <p>Remove the duplicates with the function of distinct(), assign the
  dataset as df_01:</p>
  <sec id="produce-a-table-with-missing-data">
    <title>2.1 Produce a table with missing data</title>
    <p>For date options as year, month, etc:</p>
    <preformat># A tibble: 52 × 9
# Groups:   Station.name [4]
   Station.name  Year NA_date NA_PM2 NA_PM10 NA_Vis NA_WD NA_WS NA_OPC
   &lt;chr&gt;        &lt;int&gt;   &lt;int&gt;  &lt;int&gt;   &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;
 1 Dalanzadgad   2008    4630   1543    1672   1463  1566  1566   4630
 2 Dalanzadgad   2009    8760    715     929    659   748   748   8760
 3 Dalanzadgad   2010    8784    921    1086    756   787   787   8784
 4 Dalanzadgad   2011    8760   2652    3309   1759  2394  2394   8760
 5 Dalanzadgad   2012    5088   1074    3016    693  1412  1412   5088
 6 Dalanzadgad   2013    6096   1766    1809   2479  1240  1240   6096
 7 Dalanzadgad   2014    7800    843     921   6068  1482  1482   7800
 8 Dalanzadgad   2015    8760   1539    1587   8115  2635  2635   8760
 9 Dalanzadgad   2016    6288   1654    1613   5995  3306  3306   6288
10 Dalanzadgad   2017    3264     36      45   3264  3264  3264   3264
# ℹ 42 more rows</preformat>
    <p>For station</p>
    <preformat># A tibble: 4 × 8
  Station.name NA_date NA_PM2 NA_PM10 NA_Vis NA_WD NA_WS NA_OPC
  &lt;chr&gt;          &lt;int&gt;  &lt;int&gt;   &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;
1 Dalanzadgad    69454  13081   16327  32475 20058 20058  69454
2 Sainshand     101230  27588   36117  28986 13768 13768 101230
3 UB             95662   7895    8785   3775  4121  4121  62421
4 Zamynuud       99742  32281   33597  22525  5373  5373  99742</preformat>
    <p>By percentages</p>
    <preformat># A tibble: 4 × 2
# Groups:   Station.name [4]
  Station.name   sdq
  &lt;chr&gt;        &lt;dbl&gt;
1 Dalanzadgad   10.7
2 Sainshand     25.9
3 UB            17.9
4 Zamynuud      39.6</preformat>
    <p>Note that the <monospace>echo = FALSE</monospace> parameter was
    added to the code chunk to prevent printing of the R code that
    generated the plot.</p>
  </sec>
</sec>
<sec id="remove-the-spikes-and-produce-an-extended-table">
  <title>3. Remove the spikes, and produce an extended table</title>
  <p>Remove the spikes in the datasets, and produce the table with NA,
  with removed spikes; express it in a percentages.</p>
  <sec id="remove-the-spikes-method-1.-mean-value---3-5sd">
    <title>3.0.1 Remove the spikes Method 1. Mean value +-
    (3-5)SD</title>
    <p>Method 2. Seasonal variations, and trend-mean</p>
  </sec>
  <sec id="save-dataset-in-folder-01_data_raw">
    <title>3.1 Save dataset in folder: 01_data_raw</title>
  </sec>
</sec>
<sec id="tidy-data">
  <title>4. Tidy data</title>
  <sec id="fill-the-missing-data">
    <title>4.1 Fill the missing data</title>
    <p>Method 1. Fill the gap Method 2. Relationship equation Method 3.
    Look-up table</p>
  </sec>
  <sec id="save-dataset-in-folder-02_data_tidy">
    <title>4.2 Save dataset in folder: 02_data_tidy</title>
    <p>Read a clean version of data:</p>
    <p>Create spatial plot:</p>
    <fig id="fig-spatial-plot">
      <caption><p>Figure 4: Locations of earthquakes on La Palma since
      2017</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/notebooks-01-earthquakes-fig-spatial-plot-output-1.png" />
    </fig>
    <p><xref alt="Figure 4" rid="fig-spatial-plot">Figure 4</xref> shows
    the location of recent Earthquakes on La Palma.</p>
  </sec>
  <sec id="sec-data-methods">
    <title>4.3 Data &amp; Methods</title>
  </sec>
  <sec id="sec-results">
    <title>4.4 Results</title>
  </sec>
  <sec id="sec-discussion">
    <title>4.5 Discussion</title>
  </sec>
  <sec id="sec-conclusions">
    <title>4.6 Conclusions</title>
  </sec>
  <sec id="references">
    <title>References</title>
    <ref-list>
      <ref id="ref-marrero2019">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Marrero</surname><given-names>José</given-names></name>
            <name><surname>García</surname><given-names>Alicia</given-names></name>
            <name><surname>Berrocoso</surname><given-names>Manuel</given-names></name>
            <name><surname>Llinares</surname><given-names>Ángeles</given-names></name>
            <name><surname>Rodríguez-Losada</surname><given-names>Antonio</given-names></name>
            <name><surname>Ortiz</surname><given-names>R.</given-names></name>
          </person-group>
          <article-title>Strategies for the development of volcanic hazard maps in monogenetic volcanic fields: The example of La Palma (Canary Islands)</article-title>
          <source>Journal of Applied Volcanology</source>
          <year iso-8601-date="2019-07">2019</year><month>07</month>
          <volume>8</volume>
          <pub-id pub-id-type="doi">10.1186/s13617-019-0085-5</pub-id>
          <fpage></fpage>
          <lpage></lpage>
        </element-citation>
      </ref>
    </ref-list>
  </sec>
</sec>
</body>

<back>
</back>

<sub-article article-type="notebook" id="nb-16-nb-article">
<front-stub>
<title-group>
<article-title>PM2 and PM10 concentrations</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0001-9775-1924</contrib-id>
<name>
<surname>Munkhtsetseg</surname>
<given-names>Erdenebayar</given-names>
</name>
<string-name>Erdenebayar Munkhtsetseg</string-name>

<email>e.munkhtsetseg@yahoo.com</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="project
administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration/">Project
administration</role>
<role vocab="https://credit.niso.org" vocab-term="software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software/">Software</role>
<role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
<xref ref-type="aff" rid="aff-2-nb-article">b</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0000-0000-0000-0000</contrib-id>
<name>
<surname>Shimizu</surname>
<given-names>Atsushi</given-names>
</name>
<string-name>Atsushi Shimizu</string-name>

<email>shimizua@nies.go.jp</email>
<role vocab="https://credit.niso.org" vocab-term="writing – review &amp;
editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing/">Editing</role>
<role>Revising</role>
<xref ref-type="aff" rid="aff-3-nb-article">c</xref>
<xref ref-type="corresp" rid="cor-2-nb-article">&#x002A;</xref>
</contrib>
</contrib-group>
<aff id="aff-1-nb-article">
<institution-wrap>
<institution>National University of Mongolia (NUM),
Mongolia</institution>
</institution-wrap>







</aff>
<aff id="aff-2-nb-article">
<institution-wrap>
<institution>Kanazawa University, Japan</institution>
</institution-wrap>







</aff>
<aff id="aff-3-nb-article">
<institution-wrap>
<institution>National Institute for Environmental Studies (NIES),
Japan</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-2-nb-article">shimizua@nies.go.jp</corresp>
</author-notes>
<abstract>
<p>In September 2021, a significant jump in seismic activity on the
island of La Palma (Canary Islands, Spain) signaled the start of a
volcanic crisis that still continues at the time of writing. Earthquake
data is continually collected and published by the Instituto Geográphico
Nacional (IGN). …</p>
</abstract>
</front-stub>

<body>
<sec id="introduction-nb-article">
  <title>0.1 Introduction</title>
  <sec id="nb-code-cell-1-nb-article" specific-use="notebook-code">
  <code language="r script">eruptions &lt;- c(1492, 1585, 1646, 1677, 1712, 1949, 1971, 2021)
n_eruptions &lt;- length(eruptions)</code>
  </sec>
  <sec id="cell-fig-timeline-nb-article" specific-use="notebook-code">
  <code language="r script">par(mar = c(3, 1, 1, 1) + 0.1)
plot(eruptions, rep(0, n_eruptions), 
  pch = &quot;|&quot;, axes = FALSE)
axis(1)
box()</code>
  <fig id="fig-timeline-nb-article">
    <caption><p>Figure 1: Timeline of recent earthquakes on La
    Palma</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/fig-timeline-1.png" />
  </fig>
  </sec>
  <sec id="nb-code-cell-2-nb-article" specific-use="notebook-code">
  <code language="r script">avg_years_between_eruptions &lt;- mean(diff(eruptions[-n_eruptions]))
avg_years_between_eruptions</code>
  <sec id="nb-code-cell-2-output-0-nb-article" specific-use="notebook-output">
  <preformat>[1] 79.83333</preformat>
  </sec>
  </sec>
  <p>Based on data up to and including 1971, eruptions on La Palma
  happen every 79.8 years on average.</p>
  <p>Studies of the magma systems feeding the volcano, such as Marrero
  et al.
  (<xref alt="2019" rid="ref-marrero2019-nb-article" ref-type="bibr">2019</xref>),
  have proposed that there are two main magma reservoirs feeding the
  Cumbre Vieja volcano; one in the mantle (30-40km depth) which charges
  and in turn feeds a shallower crustal reservoir (10-20km depth).</p>
  <p>Eight eruptions have been recorded since the late 1400s
  (<xref alt="Figure 1" rid="fig-timeline-nb-article">Figure 1</xref>).</p>
  <p>Data and methods are discussed in
  <xref alt="Section 4.3" rid="sec-data-methods-nb-article">Section 4.3</xref>.</p>
  <p>Let <inline-formula><alternatives>
  <tex-math><![CDATA[x]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
  denote the number of eruptions in a year. Then,
  <inline-formula><alternatives>
  <tex-math><![CDATA[x]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
  can be modeled by a Poisson distribution</p>
  <p><styled-content id="eq-poisson-nb-article"><disp-formula><alternatives>
  <tex-math><![CDATA[
  p(x) = \frac{e^{-\lambda} \lambda^{x}}{x !}
   \qquad(1)]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi>!</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[\lambda]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>
  is the rate of eruptions per year. Using
  <xref alt="Equation 1" rid="eq-poisson-nb-article">Equation 1</xref>, the
  probability of an eruption in the next <inline-formula><alternatives>
  <tex-math><![CDATA[t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
  years can be calculated.</p>
  <fig id="tbl-history-nb-article">
    <caption><p>Table 1: Recent historic eruptions on La
    Palma</p></caption>
    <table-wrap>
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Year</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Current</td>
            <td>2021</td>
          </tr>
          <tr>
            <td>Teneguía</td>
            <td>1971</td>
          </tr>
          <tr>
            <td>Nambroque</td>
            <td>1949</td>
          </tr>
          <tr>
            <td>El Charco</td>
            <td>1712</td>
          </tr>
          <tr>
            <td>Volcán San Antonio</td>
            <td>1677</td>
          </tr>
          <tr>
            <td>Volcán San Martin</td>
            <td>1646</td>
          </tr>
          <tr>
            <td>Tajuya near El Paso</td>
            <td>1585</td>
          </tr>
          <tr>
            <td>Montaña Quemada</td>
            <td>1492</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </fig>
  <p><xref alt="Table 1" rid="tbl-history-nb-article">Table 1</xref> summarises the
  eruptions recorded since the colonization of the islands by Europeans
  in the late 1400s.</p>
  <fig id="fig-map-nb-article">
    <caption><p>Figure 2: Map of La Palma</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/la-palma-map.png" />
  </fig>
  <p>La Palma is one of the west most islands in the Volcanic
  Archipelago of the Canary Islands
  (<xref alt="Figure 2" rid="fig-map-nb-article">Figure 2</xref>).</p>
  <sec id="cell-fig-spatial-plot-nb-article" specific-use="notebook-code">
  <code language="python">la_palma |&gt; 
  ggplot(aes(Longitude, Latitude)) +
  geom_point(aes(color = Magnitude, size = 40-`Depth(km)`)) +
  scale_color_viridis_c(direction = -1) + 
  scale_size(range = c(0.5, 2), guide = &quot;none&quot;) +
  theme_bw()</code>
  <sec id="cell-fig-spatial-plot-output-0-nb-article" specific-use="notebook-output">
  <fig id="fig-spatial-plot-nb-article">
    <caption><p>Figure 3: Locations of earthquakes on La Palma since
    2017</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/notebooks-explore-earthquakes-fig-spatial-plot-output-1.png" />
  </fig>
  </sec>
  </sec>
  <p>kk</p>
</sec>
<sec id="explore-earthquakes-nb-article">
  <title>1. Explore Earthquakes</title>
  <p>Munkhtsetseg</p>
  <p>Library</p>
  <sec id="f5588702-2418-4f41-af1e-583195af5703-nb-article" specific-use="notebook-code">
  <code language="python">library(tidyverse)</code>
  <sec id="f5588702-2418-4f41-af1e-583195af5703-output-0-nb-article" specific-use="notebook-output">
  <preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
  </sec>
  </sec>
</sec>
<sec id="import-the-dataset-and-remove-the-duplicates-nb-article">
  <title>2. Import the dataset and remove the duplicates</title>
  <p>Import the dataset from the directory of: ~/Data
  Input/Preprocessing data/Preprocessing data.csv, assign the dataset as
  object of df:</p>
  <sec id="cell-327e11ca-69b9-41c6-9b57-5bad4a607846-nb-article" specific-use="notebook-code">
  <code language="python">df &lt;- read.csv(&quot;~/Data Input/Preprocessing data/Preprocessing data.csv&quot;)</code>
  </sec>
  <p>Remove the duplicates with the function of distinct(), assign the
  dataset as df_01:</p>
  <sec id="cell-21a7caac-89b4-4696-8c72-c4c9ea330a58-nb-article" specific-use="notebook-code">
  <code language="python">df_01 &lt;- df %&gt;%
  distinct()</code>
  </sec>
  <sec id="produce-a-table-with-missing-data-nb-article">
    <title>2.1 Produce a table with missing data</title>
    <p>For date options as year, month, etc:</p>
    <sec id="cell-10cf91f7-d4d0-4ee3-bfcd-2e9421e4c98d-nb-article" specific-use="notebook-code">
    <code language="python">Table_NA_by_Year &lt;- df_01 %&gt;%
  rowwise %&gt;%
  group_by(Station.name,Year) %&gt;% 
  summarise(NA_date = sum(!is.na(Date)),
            NA_PM2 = sum(is.na(PM2)),
            NA_PM10 = sum(is.na(PM10)),
            NA_Vis = sum(is.na(Visibility)),
            NA_WD = sum(is.na(WD)),
            NA_WS = sum(is.na(WS)),
            NA_OPC = sum(is.na(OPC))
            ) </code>
    <sec id="cell-10cf91f7-d4d0-4ee3-bfcd-2e9421e4c98d-output-0-nb-article" specific-use="notebook-output">
    <preformat>`summarise()` has grouped output by 'Station.name'. You can override using the
`.groups` argument.</preformat>
    </sec>
    <sec id="cell-10cf91f7-d4d0-4ee3-bfcd-2e9421e4c98d-output-1-nb-article" specific-use="notebook-output">
    <preformat># A tibble: 52 × 9
# Groups:   Station.name [4]
   Station.name  Year NA_date NA_PM2 NA_PM10 NA_Vis NA_WD NA_WS NA_OPC
   &lt;chr&gt;        &lt;int&gt;   &lt;int&gt;  &lt;int&gt;   &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;
 1 Dalanzadgad   2008    4630   1543    1672   1463  1566  1566   4630
 2 Dalanzadgad   2009    8760    715     929    659   748   748   8760
 3 Dalanzadgad   2010    8784    921    1086    756   787   787   8784
 4 Dalanzadgad   2011    8760   2652    3309   1759  2394  2394   8760
 5 Dalanzadgad   2012    5088   1074    3016    693  1412  1412   5088
 6 Dalanzadgad   2013    6096   1766    1809   2479  1240  1240   6096
 7 Dalanzadgad   2014    7800    843     921   6068  1482  1482   7800
 8 Dalanzadgad   2015    8760   1539    1587   8115  2635  2635   8760
 9 Dalanzadgad   2016    6288   1654    1613   5995  3306  3306   6288
10 Dalanzadgad   2017    3264     36      45   3264  3264  3264   3264
# ℹ 42 more rows</preformat>
    </sec>
    </sec>
    <p>For station</p>
    <sec id="cell-34535933-1c52-4e7c-9119-2e846196b9d0-nb-article" specific-use="notebook-code">
    <code language="python">Table_NA_by_Station &lt;- df_01 %&gt;%
  rowwise %&gt;%
  group_by(Station.name) %&gt;% 
  summarise(NA_date = sum(!is.na(Date)),
            NA_PM2 = sum(is.na(PM2)),
            NA_PM10 = sum(is.na(PM10)),
            NA_Vis = sum(is.na(Visibility)),
            NA_WD = sum(is.na(WD)),
            NA_WS = sum(is.na(WS)),
            NA_OPC = sum(is.na(OPC))
  ) 
Table_NA_by_Station</code>
    <sec id="cell-34535933-1c52-4e7c-9119-2e846196b9d0-output-0-nb-article" specific-use="notebook-output">
    <preformat># A tibble: 4 × 8
  Station.name NA_date NA_PM2 NA_PM10 NA_Vis NA_WD NA_WS NA_OPC
  &lt;chr&gt;          &lt;int&gt;  &lt;int&gt;   &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;
1 Dalanzadgad    69454  13081   16327  32475 20058 20058  69454
2 Sainshand     101230  27588   36117  28986 13768 13768 101230
3 UB             95662   7895    8785   3775  4121  4121  62421
4 Zamynuud       99742  32281   33597  22525  5373  5373  99742</preformat>
    </sec>
    </sec>
    <p>By percentages</p>
    <sec id="d4756950-4dfa-4295-9182-a8f50b0fb40f-nb-article" specific-use="notebook-code">
    <code language="python">Table_NA_by_Station_percentage &lt;- df_01 %&gt;%
  rowwise %&gt;%
  group_by(Station.name, Year) %&gt;% 
  summarise(NA_date = sum(!is.na(Date)),
            NA_PM2 = sum(is.na(PM2)),
            NA_PM10 = sum(is.na(PM10)),
            NA_Vis = sum(is.na(Visibility)),
            NA_WD = sum(is.na(WD)),
            NA_WS = sum(is.na(WS)),
            NA_OPC = sum(is.na(OPC))
  ) %&gt;% 
  mutate(
            NA_PM2p = if_else(NA_date != NA_PM2, NA_PM2/NA_date*100, 0)
  ) %&gt;%
  do({q &lt;- .$NA_PM2*100/.$NA_date; sdq &lt;- sd(q); attr(sdq, &quot;data.all&quot;) &lt;- q; data.frame(sdq)}) </code>
    <sec id="d4756950-4dfa-4295-9182-a8f50b0fb40f-output-0-nb-article" specific-use="notebook-output">
    <preformat>`summarise()` has grouped output by 'Station.name'. You can override using the
`.groups` argument.</preformat>
    </sec>
    <sec id="d4756950-4dfa-4295-9182-a8f50b0fb40f-output-1-nb-article" specific-use="notebook-output">
    <preformat># A tibble: 4 × 2
# Groups:   Station.name [4]
  Station.name   sdq
  &lt;chr&gt;        &lt;dbl&gt;
1 Dalanzadgad   10.7
2 Sainshand     25.9
3 UB            17.9
4 Zamynuud      39.6</preformat>
    </sec>
    </sec>
    <p>Note that the <monospace>echo = FALSE</monospace> parameter was
    added to the code chunk to prevent printing of the R code that
    generated the plot.</p>
  </sec>
</sec>
<sec id="remove-the-spikes-and-produce-an-extended-table-nb-article">
  <title>3. Remove the spikes, and produce an extended table</title>
  <p>Remove the spikes in the datasets, and produce the table with NA,
  with removed spikes; express it in a percentages.</p>
  <sec id="remove-the-spikes-method-1.-mean-value---3-5sd-nb-article">
    <title>3.0.1 Remove the spikes Method 1. Mean value +-
    (3-5)SD</title>
    <p>Method 2. Seasonal variations, and trend-mean</p>
  </sec>
  <sec id="save-dataset-in-folder-01_data_raw-nb-article">
    <title>3.1 Save dataset in folder: 01_data_raw</title>
  </sec>
</sec>
<sec id="tidy-data-nb-article">
  <title>4. Tidy data</title>
  <sec id="fill-the-missing-data-nb-article">
    <title>4.1 Fill the missing data</title>
    <p>Method 1. Fill the gap Method 2. Relationship equation Method 3.
    Look-up table</p>
  </sec>
  <sec id="save-dataset-in-folder-02_data_tidy-nb-article">
    <title>4.2 Save dataset in folder: 02_data_tidy</title>
    <sec id="cell-4e7de72f-187c-4da2-9f3d-82d5229761a3-nb-article" specific-use="notebook-code">
    <code language="python">library(tidyverse)</code>
    </sec>
    <p>Read a clean version of data:</p>
    <sec id="cell-563626a1-29ed-4aba-9b02-086857b60737-nb-article" specific-use="notebook-code">
    <code language="python">la_palma &lt;- read_csv(&quot;la-palma.csv&quot;)</code>
    <sec id="cell-563626a1-29ed-4aba-9b02-086857b60737-output-0-nb-article" specific-use="notebook-output">
    <preformat>Rows: 11347 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
dbl  (4): Longitude, Latitude, Depth(km), Magnitude
dttm (1): DateTime

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
    </sec>
    </sec>
    <p>Create spatial plot:</p>
    <sec id="cell-fig-spatial-plot-nb-article" specific-use="notebook-code">
    <code language="python">la_palma |&gt; 
  ggplot(aes(Longitude, Latitude)) +
  geom_point(aes(color = Magnitude, size = 40-`Depth(km)`)) +
  scale_color_viridis_c(direction = -1) + 
  scale_size(range = c(0.5, 2), guide = &quot;none&quot;) +
  theme_bw()</code>
    <sec id="cell-fig-spatial-plot-output-0-nb-article" specific-use="notebook-output">
    <fig id="fig-spatial-plot-nb-article">
      <caption><p>Figure 4: Locations of earthquakes on La Palma since
      2017</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/notebooks-01-earthquakes-fig-spatial-plot-output-1.png" />
    </fig>
    </sec>
    </sec>
    <p><xref alt="Figure 4" rid="fig-spatial-plot-nb-article">Figure 4</xref> shows
    the location of recent Earthquakes on La Palma.</p>
  </sec>
  <sec id="sec-data-methods-nb-article">
    <title>4.3 Data &amp; Methods</title>
  </sec>
  <sec id="sec-results-nb-article">
    <title>4.4 Results</title>
  </sec>
  <sec id="sec-discussion-nb-article">
    <title>4.5 Discussion</title>
  </sec>
  <sec id="sec-conclusions-nb-article">
    <title>4.6 Conclusions</title>
  </sec>
  <sec id="references-nb-article">
    <title>References</title>
    <ref-list>
      <ref id="ref-marrero2019-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Marrero</surname><given-names>José</given-names></name>
            <name><surname>García</surname><given-names>Alicia</given-names></name>
            <name><surname>Berrocoso</surname><given-names>Manuel</given-names></name>
            <name><surname>Llinares</surname><given-names>Ángeles</given-names></name>
            <name><surname>Rodríguez-Losada</surname><given-names>Antonio</given-names></name>
            <name><surname>Ortiz</surname><given-names>R.</given-names></name>
          </person-group>
          <article-title>Strategies for the development of volcanic hazard maps in monogenetic volcanic fields: The example of La Palma (Canary Islands)</article-title>
          <source>Journal of Applied Volcanology</source>
          <year iso-8601-date="2019-07">2019</year><month>07</month>
          <volume>8</volume>
          <pub-id pub-id-type="doi">10.1186/s13617-019-0085-5</pub-id>
          <fpage></fpage>
          <lpage></lpage>
        </element-citation>
      </ref>
    </ref-list>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-4-nb-1">
<front-stub>
<title-group>
<article-title>Explore Earthquakes</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Munkhtsetseg</surname>
<given-names></given-names>
</name>
<string-name>Munkhtsetseg</string-name>

</contrib>
</contrib-group>
</front-stub>

<body>
<p>Library</p>
<sec id="nb-code-cell-1-nb-1" specific-use="notebook-code">
<code language="r script">library(tidyverse)
</code>
<code language="r script">library(ggplot2)
</code>
<sec id="nb-code-cell-1-output-0-nb-1" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
</sec>
<sec id="import-the-dataset-and-remove-the-duplicates-nb-1">
  <title>Import the dataset and remove the duplicates</title>
  <p>Import the dataset from the directory of: ~/Data
  Input/Preprocessing data/Preprocessing data.csv, assign the dataset as
  object of df:</p>
  <sec id="nb-code-cell-2-nb-1" specific-use="notebook-code">
  <code language="r script">df &lt;- read.csv(&quot;~/Data Input/Preprocessing data/Preprocessing data.csv&quot;)
  </code>
  </sec>
  <p>Remove the duplicates with the function of distinct(), assign the
  dataset as df_01:</p>
  <sec id="nb-code-cell-3-nb-1" specific-use="notebook-code">
  <code language="r script">df_01 &lt;- df %&gt;%
  distinct()
  </code>
  </sec>
  <sec id="produce-a-table-with-missing-data-nb-1">
    <title>Produce a table with missing data</title>
    <p>For date options as year, month, etc:</p>
    <sec id="nb-code-cell-4-nb-1" specific-use="notebook-code">
    <code language="r script">Table_NA_by_Year &lt;- df_01 %&gt;%
  rowwise %&gt;%
  group_by(Station.name,Year) %&gt;% 
  summarise(NA_date = sum(!is.na(Date)),
            NA_PM2 = sum(is.na(PM2)),
            NA_PM10 = sum(is.na(PM10)),
            NA_Vis = sum(is.na(Visibility)),
            NA_WD = sum(is.na(WD)),
            NA_WS = sum(is.na(WS)),
            NA_OPC = sum(is.na(OPC))
            ) 
    </code>
    <code language="r script">Table_NA_by_Year
    </code>
    <sec id="nb-code-cell-4-output-0-nb-1" specific-use="notebook-output">
    <preformat>`summarise()` has grouped output by 'Station.name'. You can override using the
`.groups` argument.</preformat>
    </sec>
    <sec id="nb-code-cell-4-output-1-nb-1" specific-use="notebook-output">
    <preformat># A tibble: 52 × 9
# Groups:   Station.name [4]
   Station.name  Year NA_date NA_PM2 NA_PM10 NA_Vis NA_WD NA_WS NA_OPC
   &lt;chr&gt;        &lt;int&gt;   &lt;int&gt;  &lt;int&gt;   &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;
 1 Dalanzadgad   2008    4630   1543    1672   1463  1566  1566   4630
 2 Dalanzadgad   2009    8760    715     929    659   748   748   8760
 3 Dalanzadgad   2010    8784    921    1086    756   787   787   8784
 4 Dalanzadgad   2011    8760   2652    3309   1759  2394  2394   8760
 5 Dalanzadgad   2012    5088   1074    3016    693  1412  1412   5088
 6 Dalanzadgad   2013    6096   1766    1809   2479  1240  1240   6096
 7 Dalanzadgad   2014    7800    843     921   6068  1482  1482   7800
 8 Dalanzadgad   2015    8760   1539    1587   8115  2635  2635   8760
 9 Dalanzadgad   2016    6288   1654    1613   5995  3306  3306   6288
10 Dalanzadgad   2017    3264     36      45   3264  3264  3264   3264
# ℹ 42 more rows</preformat>
    </sec>
    </sec>
    <p>For station</p>
    <sec id="nb-code-cell-5-nb-1" specific-use="notebook-code">
    <code language="r script">Table_NA_by_Station &lt;- df_01 %&gt;%
  rowwise %&gt;%
  group_by(Station.name) %&gt;% 
  summarise(NA_date = sum(!is.na(Date)),
            NA_PM2 = sum(is.na(PM2)),
            NA_PM10 = sum(is.na(PM10)),
            NA_Vis = sum(is.na(Visibility)),
            NA_WD = sum(is.na(WD)),
            NA_WS = sum(is.na(WS)),
            NA_OPC = sum(is.na(OPC))
  ) 
Table_NA_by_Station
    </code>
    <sec id="nb-code-cell-5-output-0-nb-1" specific-use="notebook-output">
    <preformat># A tibble: 4 × 8
  Station.name NA_date NA_PM2 NA_PM10 NA_Vis NA_WD NA_WS NA_OPC
  &lt;chr&gt;          &lt;int&gt;  &lt;int&gt;   &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;
1 Dalanzadgad    69454  13081   16327  32475 20058 20058  69454
2 Sainshand     101230  27588   36117  28986 13768 13768 101230
3 UB             95662   7895    8785   3775  4121  4121  62421
4 Zamynuud       99742  32281   33597  22525  5373  5373  99742</preformat>
    </sec>
    </sec>
    <p>By percentages</p>
    <sec id="nb-code-cell-6-nb-1" specific-use="notebook-code">
    <code language="r script">Table_NA_by_Station_percentage &lt;- df_01 %&gt;%
  rowwise %&gt;%
  group_by(Station.name, Year) %&gt;% 
  summarise(NA_date = sum(!is.na(Date)),
            NA_PM2 = sum(is.na(PM2)),
            NA_PM10 = sum(is.na(PM10)),
            NA_Vis = sum(is.na(Visibility)),
            NA_WD = sum(is.na(WD)),
            NA_WS = sum(is.na(WS)),
            NA_OPC = sum(is.na(OPC))
  ) %&gt;% 
  mutate(
            NA_PM2p = if_else(NA_date != NA_PM2, NA_PM2/NA_date*100, 0)
  ) %&gt;%
  do({q &lt;- .$NA_PM2*100/.$NA_date; sdq &lt;- sd(q); attr(sdq, &quot;data.all&quot;) &lt;- q; data.frame(sdq)}) 
    </code>
    <code language="r script"> Table_NA_by_Station_percentage
    </code>
    <sec id="nb-code-cell-6-output-0-nb-1" specific-use="notebook-output">
    <preformat>`summarise()` has grouped output by 'Station.name'. You can override using the
`.groups` argument.</preformat>
    </sec>
    <sec id="nb-code-cell-6-output-1-nb-1" specific-use="notebook-output">
    <preformat># A tibble: 4 × 2
# Groups:   Station.name [4]
  Station.name   sdq
  &lt;chr&gt;        &lt;dbl&gt;
1 Dalanzadgad   10.7
2 Sainshand     25.9
3 UB            17.9
4 Zamynuud      39.6</preformat>
    </sec>
    </sec>
    <p>Note that the <monospace>echo = FALSE</monospace> parameter was
    added to the code chunk to prevent printing of the R code that
    generated the plot.</p>
  </sec>
</sec>
<sec id="remove-the-spikes-and-produce-an-extended-table-nb-1">
  <title>Remove the spikes, and produce an extended table</title>
  <p>Remove the spikes in the datasets, and produce the table with NA,
  with removed spikes; express it in a percentages.</p>
  <sec id="remove-the-spikes-method-1.-mean-value---3-5sd-nb-1">
    <title>Remove the spikes Method 1. Mean value +- (3-5)SD</title>
    <p>Method 2. Seasonal variations, and trend-mean</p>
  </sec>
  <sec id="save-dataset-in-folder-01_data_raw-nb-1">
    <title>Save dataset in folder: 01_data_raw</title>
  </sec>
</sec>
<sec id="tidy-data-nb-1">
  <title>Tidy data</title>
  <sec id="fill-the-missing-data-nb-1">
    <title>Fill the missing data</title>
    <p>Method 1. Fill the gap Method 2. Relationship equation Method 3.
    Look-up table</p>
  </sec>
  <sec id="save-dataset-in-folder-02_data_tidy-nb-1">
    <title>Save dataset in folder: 02_data_tidy</title>
    <sec id="nb-code-cell-7-nb-1" specific-use="notebook-code">
    <code language="r script">library(tidyverse)
    </code>
    </sec>
    <p>Read a clean version of data:</p>
    <sec id="nb-code-cell-8-nb-1" specific-use="notebook-code">
    <code language="r script">la_palma &lt;- read_csv(&quot;la-palma.csv&quot;)
    </code>
    <sec id="nb-code-cell-8-output-0-nb-1" specific-use="notebook-output">
    <preformat>Rows: 11347 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
dbl  (4): Longitude, Latitude, Depth(km), Magnitude
dttm (1): DateTime

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
    </sec>
    </sec>
    <p>Create spatial plot:</p>
    <sec id="cell-fig-spatial-plot-nb-1" specific-use="notebook-code">
    <code language="r script">#|   against longitude.&quot;
la_palma |&gt; 
  ggplot(aes(Longitude, Latitude)) +
  geom_point(aes(color = Magnitude, size = 40-`Depth(km)`)) +
  scale_color_viridis_c(direction = -1) + 
  scale_size(range = c(0.5, 2), guide = &quot;none&quot;) +
  theme_bw()
    </code>
    <fig id="fig-spatial-plot-nb-1">
      <caption><p>Locations of earthquakes on La Palma since
      2017</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="01-earthquakes_files/figure-jats/fig-spatial-plot-1.png" />
    </fig>
    </sec>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-8-nb-2">
<front-stub>
<title-group>
<article-title>Explore Earthquakes</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Wickham</surname>
<given-names>Charlotte</given-names>
</name>
<string-name>Charlotte Wickham</string-name>

</contrib>
</contrib-group>
</front-stub>

<body>
<sec id="nb-code-cell-1-nb-2" specific-use="notebook-code">
<code language="r script">library(tidyverse)
</code>
<sec id="nb-code-cell-1-output-0-nb-2" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
</sec>
<p>Read a clean version of data:</p>
<sec id="nb-code-cell-2-nb-2" specific-use="notebook-code">
<code language="r script">la_palma &lt;- read_csv(&quot;la-palma.csv&quot;)
</code>
<sec id="nb-code-cell-2-output-0-nb-2" specific-use="notebook-output">
<preformat>Rows: 11347 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
dbl  (4): Longitude, Latitude, Depth(km), Magnitude
dttm (1): DateTime

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
</sec>
</sec>
<p>Create spatial plot:</p>
<sec id="cell-fig-spatial-plot-nb-2" specific-use="notebook-code">
<code language="r script">#|   against longitude.&quot;
la_palma |&gt; 
  ggplot(aes(Longitude, Latitude)) +
  geom_point(aes(color = Magnitude, size = 40-`Depth(km)`)) +
  scale_color_viridis_c(direction = -1) + 
  scale_size(range = c(0.5, 2), guide = &quot;none&quot;) +
  theme_bw()
</code>
<fig id="fig-spatial-plot-nb-2">
  <caption><p>Locations of earthquakes on La Palma since
  2017</p></caption>
  <graphic mimetype="image" mime-subtype="png" xlink:href="explore-earthquakes_files/figure-jats/fig-spatial-plot-1.png" />
</fig>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-12-nb-3">
<front-stub>
<title-group>
<article-title>01_datawork</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Munkhtsetseg</surname>
<given-names></given-names>
</name>
<string-name>Munkhtsetseg</string-name>

</contrib>
</contrib-group>
</front-stub>

<body>
<p>Library</p>
<sec id="nb-code-cell-1-nb-3" specific-use="notebook-code">
<code language="r script">library(tidyverse)
</code>
<code language="r script">library(ggplot2)
</code>
<sec id="nb-code-cell-1-output-0-nb-3" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
</sec>
<sec id="import-the-dataset-and-remove-the-duplicates-nb-3">
  <title>Import the dataset and remove the duplicates</title>
  <p>Import the dataset from the directory of: ~/Data
  Input/Preprocessing data/Preprocessing data.csv, assign the dataset as
  object of df:</p>
  <sec id="nb-code-cell-2-nb-3" specific-use="notebook-code">
  <code language="r script">df &lt;- read.csv(&quot;~/Data Input/Preprocessing data/Preprocessing data.csv&quot;)
  </code>
  </sec>
  <p>Remove the duplicates with the function of distinct(), assign the
  dataset as df_01:</p>
  <sec id="nb-code-cell-3-nb-3" specific-use="notebook-code">
  <code language="r script">df_01 &lt;- df %&gt;%
  distinct()
  </code>
  </sec>
  <sec id="produce-a-table-with-missing-data-nb-3">
    <title>Produce a table with missing data</title>
    <p>For date options as year, month, etc:</p>
    <sec id="nb-code-cell-4-nb-3" specific-use="notebook-code">
    <code language="r script">Table_NA_by_Year &lt;- df_01 %&gt;%
  rowwise %&gt;%
  group_by(Station.name,Year) %&gt;% 
  summarise(NA_date = sum(!is.na(Date)),
            NA_PM2 = sum(is.na(PM2)),
            NA_PM10 = sum(is.na(PM10)),
            NA_Vis = sum(is.na(Visibility)),
            NA_WD = sum(is.na(WD)),
            NA_WS = sum(is.na(WS)),
            NA_OPC = sum(is.na(OPC))
            ) 
    </code>
    <code language="r script">Table_NA_by_Year
    </code>
    <sec id="nb-code-cell-4-output-0-nb-3" specific-use="notebook-output">
    <preformat>`summarise()` has grouped output by 'Station.name'. You can override using the
`.groups` argument.</preformat>
    </sec>
    <sec id="nb-code-cell-4-output-1-nb-3" specific-use="notebook-output">
    <preformat># A tibble: 52 × 9
# Groups:   Station.name [4]
   Station.name  Year NA_date NA_PM2 NA_PM10 NA_Vis NA_WD NA_WS NA_OPC
   &lt;chr&gt;        &lt;int&gt;   &lt;int&gt;  &lt;int&gt;   &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;
 1 Dalanzadgad   2008    4630   1543    1672   1463  1566  1566   4630
 2 Dalanzadgad   2009    8760    715     929    659   748   748   8760
 3 Dalanzadgad   2010    8784    921    1086    756   787   787   8784
 4 Dalanzadgad   2011    8760   2652    3309   1759  2394  2394   8760
 5 Dalanzadgad   2012    5088   1074    3016    693  1412  1412   5088
 6 Dalanzadgad   2013    6096   1766    1809   2479  1240  1240   6096
 7 Dalanzadgad   2014    7800    843     921   6068  1482  1482   7800
 8 Dalanzadgad   2015    8760   1539    1587   8115  2635  2635   8760
 9 Dalanzadgad   2016    6288   1654    1613   5995  3306  3306   6288
10 Dalanzadgad   2017    3264     36      45   3264  3264  3264   3264
# ℹ 42 more rows</preformat>
    </sec>
    </sec>
    <p>For station</p>
    <sec id="nb-code-cell-5-nb-3" specific-use="notebook-code">
    <code language="r script">Table_NA_by_Station &lt;- df_01 %&gt;%
  rowwise %&gt;%
  group_by(Station.name) %&gt;% 
  summarise(NA_date = sum(!is.na(Date)),
            NA_PM2 = sum(is.na(PM2)),
            NA_PM10 = sum(is.na(PM10)),
            NA_Vis = sum(is.na(Visibility)),
            NA_WD = sum(is.na(WD)),
            NA_WS = sum(is.na(WS)),
            NA_OPC = sum(is.na(OPC))
  ) 
Table_NA_by_Station
    </code>
    <sec id="nb-code-cell-5-output-0-nb-3" specific-use="notebook-output">
    <preformat># A tibble: 4 × 8
  Station.name NA_date NA_PM2 NA_PM10 NA_Vis NA_WD NA_WS NA_OPC
  &lt;chr&gt;          &lt;int&gt;  &lt;int&gt;   &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;
1 Dalanzadgad    69454  13081   16327  32475 20058 20058  69454
2 Sainshand     101230  27588   36117  28986 13768 13768 101230
3 UB             95662   7895    8785   3775  4121  4121  62421
4 Zamynuud       99742  32281   33597  22525  5373  5373  99742</preformat>
    </sec>
    </sec>
    <p>By percentages</p>
    <sec id="nb-code-cell-6-nb-3" specific-use="notebook-code">
    <code language="r script">Table_NA_by_Station_percentage &lt;- df_01 %&gt;%
  rowwise %&gt;%
  group_by(Station.name, Year) %&gt;% 
  summarise(NA_date = sum(!is.na(Date)),
            NA_PM2 = sum(is.na(PM2)),
            NA_PM10 = sum(is.na(PM10)),
            NA_Vis = sum(is.na(Visibility)),
            NA_WD = sum(is.na(WD)),
            NA_WS = sum(is.na(WS)),
            NA_OPC = sum(is.na(OPC))
  ) %&gt;% 
  mutate(
            NA_PM2p = if_else(NA_date != NA_PM2, NA_PM2/NA_date*100, 0)
  ) %&gt;%
  do({q &lt;- .$NA_PM2*100/.$NA_date; sdq &lt;- sd(q); attr(sdq, &quot;data.all&quot;) &lt;- q; data.frame(sdq)}) 
    </code>
    <code language="r script"> Table_NA_by_Station_percentage
    </code>
    <sec id="nb-code-cell-6-output-0-nb-3" specific-use="notebook-output">
    <preformat>`summarise()` has grouped output by 'Station.name'. You can override using the
`.groups` argument.</preformat>
    </sec>
    <sec id="nb-code-cell-6-output-1-nb-3" specific-use="notebook-output">
    <preformat># A tibble: 4 × 2
# Groups:   Station.name [4]
  Station.name   sdq
  &lt;chr&gt;        &lt;dbl&gt;
1 Dalanzadgad   10.7
2 Sainshand     25.9
3 UB            17.9
4 Zamynuud      39.6</preformat>
    </sec>
    </sec>
    <p>Note that the <monospace>echo = FALSE</monospace> parameter was
    added to the code chunk to prevent printing of the R code that
    generated the plot.</p>
  </sec>
</sec>
<sec id="remove-the-spikes-and-produce-an-extended-table-nb-3">
  <title>Remove the spikes, and produce an extended table</title>
  <p>Remove the spikes in the datasets, and produce the table with NA,
  with removed spikes; express it in a percentages.</p>
  <sec id="remove-the-spikes-method-1.-mean-value---3-5sd-nb-3">
    <title>Remove the spikes Method 1. Mean value +- (3-5)SD</title>
    <p>Method 2. Seasonal variations, and trend-mean</p>
  </sec>
  <sec id="save-dataset-in-folder-01_data_raw-nb-3">
    <title>Save dataset in folder: 01_data_raw</title>
  </sec>
</sec>
<sec id="tidy-data-nb-3">
  <title>Tidy data</title>
  <sec id="fill-the-missing-data-nb-3">
    <title>Fill the missing data</title>
    <p>Method 1. Fill the gap Method 2. Relationship equation Method 3.
    Look-up table</p>
  </sec>
  <sec id="save-dataset-in-folder-02_data_tidy-nb-3">
    <title>Save dataset in folder: 02_data_tidy</title>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>

</article>